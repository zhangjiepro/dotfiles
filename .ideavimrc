" basic settings
" https://raw.githubusercontent.com/wiki/JetBrains/ideavim/set-commands.md
source ~/.vimrc

" handler

" plugins
set NERDTree
set surround
set argtextobj
set textobj-indent
set textobj-entire
set multiple-cursors
set highlightedyank
let g:highlightedyank_highlight_duration = "800"
set which-key

" goto
nmap gt <action>(GotoTest)
nmap gs <action>(GotoSuperMethod)
nmap gi <action>(GotoImplementation)
nmap gd <action>(GotoDeclaration)
nmap gD <action>(GotoTypeDeclaration)

" []
" goto n/p
nmap [[ <action>(MethodUp)
nmap ]] <action>(MethodDown)
nmap [e <action>(GotoPreviousError)
nmap ]e <action>(GotoNextError)
nmap [o <action>(PreviousOccurence)
nmap ]o <action>(NextOccurence)
nmap [c <action>(JumpToLastChange)
nmap ]c <action>(JumpToNextChange)
nmap ]g <Action>(VcsShowNextChangeMarker)
nmap [g <Action>(VcsShowPrevChangeMarker)

" tab
let g:WhichKeyDesc_X = "<leader>x Close"
let g:WhichKeyDesc_XX = "<leader>xx Close"
let g:WhichKeyDesc_XA = "<leader>xa CloseAll"
let g:WhichKeyDesc_XO = "<leader>xo CloseAllButActive"
let g:WhichKeyDesc_XP = "<leader>xp CloseUnpinned"
" nmap 1<Tab> <action>(GoToTab1)
" nmap 2<Tab> <action>(GoToTab2)
" nmap 3<Tab> <action>(GoToTab3)
" nmap 0<Tab> <action>(GoToLastTab)
" nmap <C-Tab> <action>(Switcher)
nmap <leader>xx <action>(CloseContent)
nmap <leader>xa <action>(CloseAllEditors)
nmap <leader>xo <action>(CloseAllEditorsButActive)
nmap <leader>xp <action>(CloseAllUnpinnedEditors)

" map <C-\> <action>(SplitVrtically)
" map <C--> <action>(SplitHorizontally)
" map <C-BS> <action>(Unsplit)

" collapse
nmap zC <action>(CollapseAllRegions)
nmap zO <action>(ExpandAllRegions)
nmap zm <action>(MaximizeEditorInSplit) \| <action>(HideAllWindows)
nmap zp <action>(TogglePresentationMode)
nmap zf <action>(ToggleFullScreen)

" bookmark
nmap mm <action>(ToggleBookmark)
nmap ms <action>(ShowBookmarks)

" file action
let g:WhichKeyDesc_F = "<leader>f File/Find"
let g:WhichKeyDesc_FR = "<leader>fr RecentFiles"
let g:WhichKeyDesc_FL = "<leader>fl RecentLocations"
let g:WhichKeyDesc_FF = "<leader>ff GotoFile"
let g:WhichKeyDesc_FC = "<leader>fc GotoClass"
let g:WhichKeyDesc_FS = "<leader>fs SelectInProjectView"
let g:WhichKeyDesc_FA = "<leader>fa GotoAction"
let g:WhichKeyDesc_FH = "<leader>fh LocalHistory"
let g:WhichKeyDesc_FW = "<leader>fw FindSelectionInPath"
let g:WhichKeyDesc_FN = "<leader>fn NewFile"
nmap <leader>fr <action>(RecentFiles)
nmap <leader>fl <action>(RecentLocations)
nmap <leader>ff <action>(GotoFile)
" nmap <C-f> <action>(GotoFile) by idea
nmap <leader>fc <action>(GotoClass)
nmap <leader>fa <action>(GotoAction)
nmap <leader>fh <action>(LocalHistory.ShowHistory)
nmap <leader>fn <action>(NewElement)
map <leader>fw viw<leader>fw<Esc>
vmap <leader>fw <action>(FindSelectionInPath)<Esc>

" window by idea keymap
" map <A-1> <action>(ActivateTerminalToolWindow)
" map <A-BS> <action>(HideActiveWindow)

" editor
map <CR> <action>(EditorSelectWord)
map <S-CR> <action>(EditorUnSelectWord)
imap <C-CR> <action>(EditorCompleteStatement)
imap <C-BS> <action>(EditorDeleteToWordStart)
map / <action>(Replace)
map <A-p> <action>(ParameterInfo)
" map <A-i> <action>(Generate) by idea
map <A-o> <action>(FileStructurePopup)
map <A-u> <action>(FindUsages)
map <A-j> <action>(MoveStatementDown)
imap <A-j> <action>(MoveStatementDown)
map <A-k> <action>(MoveStatementUp)
imap <A-k> <action>(MoveStatementUp)
map <A-d> <action>(QuickImplementations)
imap <A-d> <action>(QuickImplementations)
imap <C-u> <action>($Undo)
imap <A-p> <action>(ParameterInfo)
map <A-e> <action>(ShowErrorDescription)
imap <A-e> <action>(ShowErrorDescription)
imap <A-/> <action>(CodeCompletion)
" map <S-CR> <action>(EditorSplitLine)
map <C-i> <action>(Forward)
map <C-o> <action>(Back)

" Refactor
map <A-m> <action>(ExtractMethod)
map <A-f> <action>(IntroduceField)
map <A-v> <action>(IntroduceVariable)
map <A-c> <action>(IntroduceConstant)
map <A-s> <action>(ChangeSignature)
map <A-l> <action>(Inline)
map <A-r> <action>(RenameElement)
map <C-r> <action>(Refactorings.QuickListPopupAction)
map <C-m> <action>(Move)
map <C-e> <action>(SelectInProjectView)
" format
map = <action>(ReformatCode) \| <action>(OptimizeImports)

" Git
let g:WhichKeyDesc_G = "<leader>g Git"
let g:WhichKeyDesc_GR = "<leader>gr RollbackChangedLines"
let g:WhichKeyDesc_GC = "<leader>gc CheckinProject"
let g:WhichKeyDesc_GH = "<leader>gh ShowFileHistory"
let g:WhichKeyDesc_GP = "<leader>gp UpdateFiles"
nmap <leader>gr <action>(Vcs.RollbackChangedLines)
nmap <leader>gc <action>(CheckinProject)
nmap <leader>gh <action>(Vcs.ShowTabbedFileHistory)
nmap <leader>gp <action>(UpdateFiles)

" command
let g:WhichKeyDesc_CR = "\\r Run"
let g:WhichKeyDesc_CD = "\\d Debug"
let g:WhichKeyDesc_CB = "\\b ReBuild"
nmap \r <action>(Rerun) \| <action>(RunClass)
nmap \R <action>(ChooseRunConfiguration)
nmap \d <action>(DebugClass)
nmap \D <action>(ChooseDebugConfiguration)
nmap \b <action>(Debugger.ReloadFile)
nmap \t <action>(RerunFailedTests) \| <action>(RunClass)
" y
let g:WhichKeyDesc_YP = "yp CopyAbsolutePath"
let g:WhichKeyDesc_YN = "yn CopyFileName"
nmap yp <action>(CopyAbsolutePath)
nmap yn <action>(CopyFileName)
" t
" translation (required idea plugin: translation)
let g:WhichKeyDesc_TS = "ts Translate"
nmap ts <action>($InclusiveTranslateAction)
vmap ts <action>($EditorTranslateAction)<Esc>
nmap tS <Action>($ShowTranslationDialogAction)